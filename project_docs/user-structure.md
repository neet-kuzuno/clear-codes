# ユーザーフローとプロジェクト構造

## ユーザージャーニー 🚶‍♂️

### 1. コード翻訳フロー

**ステップ1: コードの選択**
プログラミングコードやエラーメッセージが表示されているウェブページで、理解したいテキストを選択します。

**ステップ2: 拡張機能の起動**
以下のいずれかの方法で拡張機能を起動します：
- Chromeツールバーの拡張機能アイコンをクリック
- 選択したテキストを右クリックして「ClearCodes: コードを翻訳」を選択
- ショートカットキー（例：Ctrl+Shift+C）を押す

**ステップ3: 翻訳の実行**
拡張機能のポップアップが表示されたら「翻訳」ボタンをクリックします。
初めて使う場合は、APIキーの設定が必要です。

**ステップ4: 結果の確認**
翻訳されたわかりやすい説明が表示されます。
「コピー」ボタンでテキストをコピーしたり、「保存」ボタンで後で見返せるように保存できます。

![ユーザーフロー図](../assets/img/user-flow.png)

### 2. 設定変更フロー

**ステップ1: 設定画面を開く**
拡張機能ポップアップの歯車アイコンをクリックします。

**ステップ2: APIキーの設定**
Google GeminiのAPIキーを入力します。

**ステップ3: 表示設定のカスタマイズ**
- テーマカラーの選択（ライト/ダーク/システム）
- フォントサイズの調整
- 言語モードの選択（普通/やさしい）

**ステップ4: 設定の保存**
「保存」ボタンをクリックして設定を保存します。

### 3. 履歴確認フロー

**ステップ1: 履歴画面を開く**
拡張機能ポップアップの「履歴」タブをクリックします。

**ステップ2: 過去の翻訳結果の閲覧**
リストから見たい翻訳結果を選択します。

**ステップ3: アクション**
- 「削除」ボタンで履歴から削除
- 「再翻訳」ボタンで同じテキストを再度翻訳
- 「コピー」ボタンで結果をクリップボードにコピー

## データフロー図 📊

```
ユーザー
  ↓
ウェブページ上のコード選択
  ↓
拡張機能ポップアップ表示
  ↓
翻訳リクエスト ──→ Chrome Background Script
                      ↓
                    Gemini API
                      ↓
                    翻訳結果
                      ↓
                  ポップアップUI
  ↓
結果表示 ───→ ローカルストレージ（履歴保存）
  ↓
ユーザーアクション（コピー/保存/共有）
```

## プロジェクトファイル構造 📁

```
clear-codes/
├── node_modules/        # 依存パッケージ
├── project-docs/        # プロジェクトドキュメント
│   ├── overview.md      # プロジェクト概要
│   ├── requirements.md  # 要件と機能
│   ├── tech-specs.md    # 技術仕様
│   ├── user-structure.md # ユーザーフローとプロジェクト構造
│   └── timeline.md      # プロジェクトタイムライン
├── public/              # 静的ファイル
│   ├── manifest.json    # 拡張機能マニフェスト
│   ├── icons/           # アイコン画像
│   └── _locales/        # 翻訳ファイル（将来対応）
├── src/                 # ソースコード
│   ├── assets/          # 画像やアイコン
│   ├── components/      # Reactコンポーネント
│   │   ├── ActionButton.jsx  # アクションボタン
│   │   ├── InputBox.jsx      # 入力ボックス
│   │   ├── OutputBox.jsx     # 出力ボックス
│   │   └── SettingsPanel.jsx # 設定パネル
│   ├── hooks/           # カスタムフック
│   │   ├── useGemini.js      # Gemini API連携
│   │   ├── useStorage.js     # ストレージアクセス
│   │   └── useHistory.js     # 履歴管理
│   ├── pages/           # ページコンポーネント
│   │   ├── Popup.jsx         # メインポップアップ
│   │   └── Options.jsx       # 設定ページ
│   ├── utils/           # ユーティリティ関数
│   │   ├── storage.js        # ストレージ操作
│   │   └── helpers.js        # ヘルパー関数
│   ├── background.js    # バックグラウンドスクリプト
│   ├── content.js       # コンテンツスクリプト
│   ├── index.jsx        # ポップアップのエントリーポイント
│   └── options.jsx      # 設定ページのエントリーポイント
├── dist/                # ビルド済みファイル
├── .eslintrc.js         # ESLint設定
├── .prettierrc          # Prettier設定
├── package.json         # パッケージ定義
├── README.md            # プロジェクト説明
├── tailwind.config.js   # Tailwind CSS設定
└── vite.config.js       # Vite設定
```

## 画面遷移図 🖥️

```
ポップアップ（メイン画面）
     │
     ├─── 設定画面
     │      │
     │      └─── APIキー設定サブ画面
     │
     ├─── 履歴画面
     │      │
     │      └─── 履歴詳細画面
     │
     └─── 学習モード画面
            │
            └─── トピック詳細画面
```

## コンポーネント関係図 🔄

```
App
├── Header
│   ├── Logo
│   └── NavTabs
│
├── Popup (メイン画面)
│   ├── InputBox
│   ├── ActionButton
│   └── OutputBox
│
├── Settings (設定画面)
│   ├── APIKeyInput
│   ├── ThemeSelector
│   └── LanguageModeSelector
│
├── History (履歴画面)
│   ├── HistoryList
│   └── HistoryItem
│
└── Footer
    └── VersionInfo
```

## データモデル 📊

### 1. 翻訳履歴エントリ

```javascript
{
  id: "unique-id-123",           // 一意のID
  originalText: "console.log()", // 元のコード
  translatedText: "画面に表示するための命令です", // 翻訳結果
  language: "javascript",        // プログラミング言語
  createdAt: "2023-07-15T12:30:00Z", // 作成日時
  isFavorite: false              // お気に入り状態
}
```

### 2. ユーザー設定

```javascript
{
  apiKey: "your-api-key-here",  // Google Gemini APIキー
  theme: "dark",                // テーマ設定（light/dark/system）
  fontSize: "medium",           // フォントサイズ（small/medium/large）
  languageMode: "simple",       // 言語モード（normal/simple）
  maxHistoryItems: 50,          // 保存する履歴の最大数
  autoDetectLanguage: true      // 言語自動検出の設定
}
```

### 3. 学習リソース

```javascript
{
  id: "topic-001",
  title: "変数とは",
  content: "変数はデータを一時的に保存する箱のようなものです...",
  category: "基本概念",
  examples: [
    {
      code: "let name = 'ユーザー名';",
      explanation: "nameという変数に'ユーザー名'というテキストを保存しています"
    }
  ],
  relatedTopics: ["topic-002", "topic-005"]
}
```

## ユーザーペルソナ 👤

### 初心者プログラマー「たろう」（14歳）
- **背景**: 中学校でプログラミングクラブに所属したばかり
- **目標**: 基本的なプログラミング概念を理解したい
- **課題**: エラーメッセージが英語で理解できない
- **使用方法**: 学校の課題でつまずいたときに使用
- **期待すること**: わかりやすい説明と具体例

### 部活動顧問「佐藤先生」（42歳）
- **背景**: 情報科の教員だが、プログラミングは専門外
- **目標**: 生徒たちの質問に適切に回答したい
- **課題**: 専門的なコードの意味を理解するのが難しい
- **使用方法**: 授業準備や生徒の質問対応時に使用
- **期待すること**: 教育的な説明と指導のヒント

## アクセシビリティへの配慮 ♿

1. **キーボードナビゲーション**
   - すべての機能がキーボードのみで操作可能
   - フォーカス状態が視覚的に明確

2. **スクリーンリーダー対応**
   - 適切な aria ラベルとロール
   - 意味のある見出し構造

3. **コントラストと可読性**
   - テキストと背景のコントラスト比は4.5:1以上
   - フォントサイズの調整機能

4. **言語の簡素化**
   - 技術的な専門用語を簡単な言葉で説明
   - 複雑な概念を段階的に理解できる構造

## 国際化対応（将来計画） 🌍

- 多言語UI（日本語、英語、中国語など）
- 文化的に適切な例示
- 右から左へ書く言語（RTL）のサポート
- 各言語固有のプログラミング用語対応

## エラーハンドリングフロー ⚠️

```
ユーザーアクション
  ↓
エラー発生
  ↓
エラータイプの判別
  ├── ネットワークエラー → 再接続を促すメッセージ
  ├── APIエラー → ユーザーフレンドリーなエラーメッセージ
  ├── 入力エラー → 具体的な修正方法の提案
  └── 内部エラー → エラーログの記録とフォールバックUI
  ↓
リカバリーオプションの提示
  ↓
ユーザーによる修正または再試行
```

## 性能指標 ⚡

- ポップアップ表示: 300ms以内
- 翻訳処理: 入力サイズに応じて1-5秒
- メモリ使用量: 50MB以下
- ストレージ使用量: 最大10MB
- バッテリー消費: 低（バックグラウンド動作なし）
